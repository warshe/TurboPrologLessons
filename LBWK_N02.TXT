****************************************************************
***      Айзикович А.А.,    МК  ИМИ,         март 1992.      ***
***      Айзикович А.А.,   ПМИ ИжГТУ,    сентябрь 1994.      ***
****************************************************************
***                 Лабораторная работа N 2                  ***
***         "Синтаксис и семантика пролог-программ.          ***
***             Некоторые операции над списками"             ***
****************************************************************

            3. Синтаксис и семантика пролог-программ

3.1. Отработайте    понятие    "переменная",    используя   файл
     exmpl201.pro.

3.2. Отработайте понятия "структура" и "сопоставление",  исполь-
     зуя файлы exmpl202.pro, exmpl203.pro.

3.3. Отработайте понятие "процедурная семантика".
     a) Войдите в  Турбо-пролог.  Установите  режим  трассировки
        программы:
        <Alt-O>, Compiler directives, Trace Off, Trace;
     b) наберите   текст  программы  или  воспользуйтесь  файлом
        exmpl204.pro:

        PREDICATES
           big(symbol)
           small(symbol)
           brown(symbol)
           black(symbol)
           grey(symbol)
           dark(symbol)
        CLAUSES
           big(bear).             /* большой медведь */
           big(elephant).         /* большой слон */
           small(cat).            /* маленький кот */
           brown(bear).           /* коричневый медведь */
           black(cat).            /* черный кот */
           grey(elephant).        /* серый слон */
           dark(Z):-black(Z).     /* темный */
           dark(Z):-brown(Z).

     c) отработайте цели ?- big(X), dark(X).
                         ?- dark(X), big(X).
        (Запуск программы - <Alt-R>, трассировка - <F10>.)
        Какая цель достигается быстрее и почему ?

3.4. Поэкспериментируйте с программой exmpl205.pro, решающей за-
     дачу об обезьяне и банане.  Отработайте цель
     GOAL:
     can_take(state("by_door","on_floor","by_window","no_has")),
     ставя последовательно на первое место  правила  "схватить",
     "залесть",  "передвинуть", "перейти". Всегда ли будут полу-
     чены решения ?

3.5. На примере программы "Родственные отношения" (exmpl206.pro)
     еще раз убедитесь в опасности переупорядочивания передложе-
     ний и целей. Отработайте цель
               ?-predokI(liz,jim)    (I=1,2,3,4)
     для всех четырех вариантов описания предиката 'predokI'.

3.6. a)  Следующую  программу   отработайте   на   микро-прологе
       (exmpl201.p).

     ((рыбы) (рыба X) (PP X) FAIL)     (* 1 *)
     ((рыба окунь))                    (* 2 *)
     ((рыба щука))                     (* 3 *)
     ((рыба лещ))                      (* 4 *)

     Что напечатает программа? Что изменилось по сравнению с Ва-
     шими  первыми программами?  Встроенный предикат FAIL всегда
     иметь значение false,  и цель не достигается. Это соответс-
     твует откату в движении по графу целей.

     b) Работу пролог-системы можно описать следующим протоколом.

     Шаг   Состояние полки целей   Номер предложения,   "голова"
           с предисторией          которого  совпадает  с первой
                                   целью полки целей (первое  из
                                   возможных предложений, позво-
                                   ляющих получить новую резоль-
                                   венту)

      1     (рыбы)                   1
      2     (рыбы)                   1
            (рыба X) (PP X) FAIL     2
      3     (рыбы)                   1
            (рыба X) (PP X) FAIL     2
            (PP окунь) FAIL                Цель PP достигается
                                             ("окунь")
      4     (рыбы)                   1
            (рыба X) (PP X) FAIL     2
            (PP окунь) FAIL
            FAIL                           Цель FAIL не достига-
                                             ется, откат
      5     (рыбы)                   1
            (рыба X) (PP X) FAIL     2
            (PP окунь) FAIL                PP - встроенный пре-
                                              дикат, откат
      6     (рыбы)                   1
            (рыба X) (PP X) FAIL     3     Движение по лабиринту,
                                             N 2 помечен
      7     (рыбы)                   1
            (рыба X) (PP X) FAIL     3
            (PP щука) FAIL                 Цель достигается
                                             ("щука")
      8     (рыбы)                   1
            (рыба X) (PP X) FAIL     3
            (PP щука) FAIL
            FAIL                           Откат
      9     (рыбы)                   1
            (рыба X) (PP X) FAIL     3
            (PP щука) FAIL                 Откат
     10     (рыбы)                   1
            (рыба X) (PP X) FAIL     4
     11     (рыбы)                   1
            (рыба X) (PP X) FAIL     4
            (PP лещ) FAIL                  Цель достигается
                                             ("лещ")
     12     (рыбы)                   1
            (рыба X) (PP X) FAIL     4
            (PP лещ) FAIL
            FAIL                           Откат
     13     (рыбы)                   1
            (рыба X) (PP X) FAIL     4
            (PP лещ) FAIL                  Откат
     14     (рыбы)                   1
            (рыба X) (PP X) FAIL           Нет предложения с N 5,
                                             откат
     15     (рыбы)                         Откат, полка целей
                                             пуста, конец.

     c) Измените программу exmpl201.p,  вставив первое предложе-
        ние между другими,  а затем сделайте его последним.  Как
        изменится работа пролог-системы?  Сколько будет этапов в
        протоках?

     d) Протокол можно представить в виде  графа,  располагая  в
        его вершинах первые цели.  В нашем случае это будет сле-
        дующий граф.

                               |   /----> Неудача
                               v  |
                              (рыбы)
                               |  ^
                               v  |
                /----<-------(рыба X)------->----\
              /    /--------/  |  |  \--------\    \
             |    ^            |  ^           |    ^
             v    |            v  |           v    |
            (PP окунь)       (PP щука)       (PP лещ)
             |  ^              |  ^             |  ^
             v  |              v  |             v  |
             FAIL              FAIL             FAIL

3.7. Отработайте программу нахождения остатка  от  деления  двух
     натуральных чисел (exmpl202.p):

     ((остаток X Y) (F X Y Z) (PP Z))
     ((F X Y X) (LESS X Y))
     ((F X Y Z) (SUM x Y X) (F x Y Z))

     Встроенный предикат LESS описывает отношение "меньше".

3.8. Следующая программа (exmpl203.p) выбирает четные числа.

     ((even (x|X) (ev x) (even X))
     ((ev x) (TIMES x1 2 x) (TIMES x1 2 x) (PP x))
     ((ev x))

     Разберите ее декларативную и процедурную семантику.

================================================================

               4. Некоторые операции над списками

4.1. В среде Турбо-пролога с помощью программы (exmpl401 .pro)

     DOMAINS
        lsymbol=symbol*
     PREDICATES
        list(lsymbol)
     CLAUSES
        list([]).
        list(_|X):-list(X).

     убедитесь в следующих равенствах, обеспечивающих различные
     представления одного и того же списка,
     [a,b,c] = [a|[b,c]] = [a,b|[c]] = [a,b,c|[]].
     Обратите внимание на способ описания списка, его запись и
     запись пустого списка.

4.2. В среде Турбо-пролога отработайте программу (exmpl402.pro),
     реализующую предикат принадлежности элемента списку.

     DOMAINS
        slist = symbol*
     PREDICATES
        member(symbol,slist)
     CLAUSES
        member(X,[X|Tail]).
        member(X,[Head|Tail]):-        /*  [Голова|Хвост]  */
           member(X,Tail).

     Установите, принадлежит ли данный элемент заданному списку,
     и какие элементы входят в список.

4.3. В среде Турбо-пролога отработайте программу exmpl403.pro,
     реализующую сцепление двух списков.

     DOMAINS
        slist = symbol*
     PREDICATES
        concaten(slist,slist,slist)
     CLAUSES
        concaten([],Y,Y).
        concaten([Xh|X],Y,[Xh|Z]):-
           concaten(X,Y,Z).

     Отработайте различные цели, используя программу как для
     сцепления списков, так и для разбиения списка на известные
     или неизвестные части. Например, отработайте цели:
     a) ?- concaten([a,b],[c,d],Z),
     b) ?- concaten([a,b,c],["1","2","3"],Z),
     c) ?- concaten(X,Y,[a,b,c]),
     d) ?- concaten([a],Y,[a,b,c]),
     e) ?- concaten(X,[b,c],[a,b,c]),
     f) ?- concaten([a],[b,c],[a,b,c]),
     g) ?- concaten([a],[b,c],[a,b,c,d]).

4.4. Примените программу из 4.3 для поиска в списке комбинации
     элементов, отвечающей некоторому условию, заданному в виде
     шаблона или образца. Например, выполните цели:
     a) ?- concaten(Before,[may|After],
          [jan,feb,mar,apr,may,jun,jul,aug,sep,okt,nov,dec]),
     b) ?- concaten(_,[Month1,may,Month2|_],
            [jan,feb,mar,apr,may,jun,jul,aug,sep,okt,nov,dec]).

4.5. Универсальность программы из 4.3 потверждает также возмож-
     ность решения новых задач. Например, выясните, что проис-
     ходит при доcтижении цели
     _L1=[a,b,z,z,c,z,z,z,d,e],concaten(L2,[z,z,z|_],L1)
     Придумайте другие цели , демонстрирующие гибкость исследу-
     емой программы.

4.6. В среде Турбо-пролога отработайте программу exmpl404.pro,
     реализующую сцепление двух списков с использованием
     конкатенации.

     DOMAINS
       slist = symbol*
     PREDICATES
       concaten(slist,slist,slist)
       member(symbol,slist)
     CLAUSES
       concaten([],Y,Y).
       concaten([Xh|X],Y,[Xh|Z]):-
       concaten(X,Y,Z).
       member(X,L):-
         concaten(_,[X|_],L).

     Сравните декларативные и процедурные смыслы программ
     exmpl403.pro и examp404.pro, получите их трассировки для
     цели ?- member(b,[a,b,c]).

4.7. В среде Турбо-пролога отработайте программы exmpl405.pro
     и exmpl406.pro, определяющие последний элемент списка.

     /*  exmpl405.pro  */

     DOMAINS
       slist = symbol*
     PREDICATES
       last(slist,symbol)
     CLAUSES
       last([X|[]],X).
       last([_|Z],X):-
         last(Z,X).

     /*  exmpl406.pro  */

     DOMAINS
       slist = symbol*
     PREDICATES
       concaten(slist,slist,slist)
       last(slist,symbol)
     CLAUSES
       last(L,X):-
         concaten(_,[X],L).
       concaten([],Y,Y).
       concaten([Xh|X],Y,[Xh|Z]):-
         concaten(X,Y,Z).

================================================================
